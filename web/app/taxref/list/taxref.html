    <div ng-include src="'app/components/header-template.html'"  onload=""  autoscroll=""></div>

    <!--Contenu global de la page-->
    <div class="container main-zone" style="padding:1px" >
       <!--Panel général de la page-->
        <div class="panel panel-default" id="taxref-zone" style="padding:10px">
            <!--Titre du panel général contenant les principaux boutons d'action-->
            <div class="panel-heading">
                <div class="row">
                    <button class="btn btn-success btn-md col-md-3" href="" ng-click="ctrl.toggleSearchTaxon()">{{ctrl.labelSearchTaxon}}</button>
                    <button class="btn btn-success btn-md col-md-3" ng-click="ctrl.isCollapsedColumn = !ctrl.isCollapsedColumn"  ng-init="ctrl.isCollapsedColumn=true;" tooltip-html-unsafe="<b>Tableau des résultats.</b> <br/>Afficher uniquement les colonnes d'information du taxref dont vous avez besoin.">Affichage des colonnes</button>
                    <div class="btn-group col-md-6" tooltip-html-unsafe="<b>Filtrer le résultat.</b> <br/>Afficher tous les taxons, ou seulement les taxons de référence.">
                        <label class="btn btn-success" ng-model="ctrl.validName" btn-radio="'txAll'">Tous les taxons</label>
                        <label class="btn btn-success" ng-model="ctrl.validName" btn-radio="'txRef'">Taxons de référence</label>
                    </div>
                </div>
            </div>

            <!--Corps du panel général-->
            <div class="panel-body">

                <!--Zone de recherche repliable avec la propriété "collapse"-->
                <div ng-hide="ctrl.isCollapsedSearchTaxon" class="row form-group" id="search-taxon">
                    <h4>Recherche</h4>
                    <form id="tx-form" class="form-horizontal">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="col-md-9" tooltip-html-unsafe="<b>Entrer ici un cd_nom.</b> <br/>Si vous connaissez le cd_nom du taxon, c'est le moyen le plus rapide d'y accéder">
                                    <input type="text" id="tbcdNom" class="form-control" aria-describedby="sizing-addon2" ng-model="ctrl.cd" placeholder="Choisir un cd_nom valide" >
                                </div>
                                <button class="btn btn-success col-md-3" ng-click="ctrl.findCdNom(ctrl.cd)" tooltip="Lancer la recherche">
                                    <span class="glyphicon glyphicon-search"></span>
                                </button>
                            </div>
                            <div class="col-md-8">
                                <div class="col-md-10" tooltip-html-unsafe="<b>Entrer ici un nom latin.</b> <br/>Une liste des 10 premiers noms correspondants vous sera proposées en auto-complétion">
                                  <input type="text" id="fTaxon"
                                      placeholder="Choisir un nom latin"
                                      ng-model="ctrl.taxonSelected"
                                      typeahead-wait-ms="200"
                                      typeahead-min-length="3"
                                      typeahead-editable="false"
                                      uib-typeahead="tax for tax in ctrl.getTaxrefIlike($viewValue)"
                                      autocomplete="off"
                                      class="form-control">
                                </div>
                                <button class="btn btn-success col-md-2" ng-click="ctrl.findLbNom(ctrl.taxonSelected)" tooltip="Lancer la recherche">
                                    <span class="glyphicon glyphicon-search"></span>
                                </button>
                            </div>
                        </div>
                      <span>
                        <search-hierachie-dir on-search="ctrl.findTaxonsByHierarchie(data)" search-url='taxref/hierarchie/' />
                      </span>
                    </form>
                </div>

                <hr/>

                <!--Zone de gestion de l'affichage des colonnes repliable avec la propriété "collapse"-->
                <div class="well" ng-hide="ctrl.isCollapsedColumn">
                  <div style="margin-bottom: 20px">
                    <label class="checkbox-inline" ng-repeat="col in ctrl.tableCols">
                      <input type="checkbox" ng-model-options="{ getterSetter: true }" ng-model="col.show"/> {{col.title}}
                    </label>
                  </div>
                </div>

                <!--Tableau de résultat de la recherche-->
                <div class="row">
                    <div><h3>RESULTATS : INFORMATIONS DU TAXREF</h3></div>
                    <table ng-table="ctrl.tableParams" show-filter="true" class="table table-condensed table-bordered table-striped">
                        <tbody>
                            <tr
                                class="active notref"
                                ng-repeat="tax in $data"
                                ng-class="{ 'warning ref':  tax.cd_nom ==  tax.cd_ref }">
                                <td data-title="'Ajout'">
                                    <a class="button" href="#/taxonform/new/{{tax.cd_nom}}" tooltip="Ajouter ce taxon à la liste des taxons de ma structure" class="btn btn-success" >
                                        <span class="glyphicon glyphicon-plus-sign"></span>
                                    </a>
                                </td>
                                <td data-title="'Voir'">
                                    <button ng-click="ctrl.open( tax.cd_nom)" tooltip="Voir toutes les informations disponibles sur ce taxons" class="btn btn-success" >
                                        <span class="glyphicon glyphicon-eye-open"></span>
                                    </button>
                                </td>

                                <td data-title="'cd_nom'" sortable="'cd_com'" ng-if="ctrl.tableCols['cd_nom'].show">{{ tax.cd_nom }}</td>
                                <td data-title="'cd_ref'" sortable="'cd_ref'" ng-if="ctrl.tableCols['cd_ref'].show">{{  tax.cd_ref }}</td>
                                <td data-title="'Nom complet'" sortable="'nom_complet'" filter="{ 'nom_complet': 'text' }"  ng-if="ctrl.tableCols['nom_complet'].show">{{ tax.nom_complet }}</td>
                                <td data-title="'Nom vernaculaire'" sortable="'nom_vern'" filter="{ 'nom_vern': 'text' }"  ng-if="ctrl.tableCols['nom_vern'].show">{{ tax.nom_vern }}</td>
                                <td data-title="'Règne'" sortable="'regne'" filter="{ 'regne': 'text' }"  ng-if="ctrl.tableCols['regne'].show">{{ tax.regne }}</td>
                                <td data-title="'Phylum'" sortable="'phylum'" filter="{ 'phylum': 'text' }"  ng-if="ctrl.tableCols['phylum'].show">{{ tax.phylum }}</td>
                                <td data-title="'Classe'" sortable="'classe'" filter="{ 'classe': 'text' }"  ng-if="ctrl.tableCols['classe'].show">{{ tax.classe }}</td>
                                <td data-title="'Ordre'" sortable="'ordre'" filter="{ 'ordre': 'text' }"  ng-if="ctrl.tableCols['ordre'].show">{{ tax.ordre }}</td>
                                <td data-title="'Famille'" sortable="'famille'" filter="{ 'famille': 'text' }"  ng-if="ctrl.tableCols['famille'].show">{{ tax.famille }}</td>
                                <td data-title="'group1_inpn'" sortable="'group1_inpn'" filter="{ 'group1_inpn': 'text' }"  ng-if="ctrl.tableCols['group1_inpn'].show">{{ tax.group1_inpn }}</td>
                                <td data-title="'group2_inpn'" sortable="'group2_inpn'" filter="{ 'group2_inpn': 'text' }"  ng-if="ctrl.tableCols['group2_inpn'].show">{{ tax.group2_inpn }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
